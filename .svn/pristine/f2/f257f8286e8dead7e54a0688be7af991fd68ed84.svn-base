<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kongkong.member.dao.IMemberDao">

	<sql id="searchWhereClause">
 		<if test="@org.apache.commons.lang3.StringUtils@isNotBlank(searchWord)">
 			<choose>
 				<when test='searchType == "T"'>
 					AND mem_id   LIKE '%' || #{searchWord} || '%'
 				</when>
 				<when test='searchType == "W"'>
 					AND mem_name  LIKE '%' || #{searchWord} || '%'
 				</when>
 				<otherwise>
 					AND mem_id   LIKE '%' || #{searchWord} || '%'
 				</otherwise>
 			</choose>
 		</if>
 	</sql>

	<select id="getMemberList" resultType="com.kongkong.member.vo.MemberVO">
	<include refid="common.BEFORE_PAGING_QRY" />
		SELECT mem_id	
			 , mem_pass
			 , mem_name  	
			 , mem_like 
		  FROM member
		 WHERE 1 = 1  
		<include refid="searchWhereClause"/>
		ORDER BY mem_id DESC	
	<include refid="common.AFTER_PAGING_QRY" />			
	</select>
	
	
	<select id="getMember" resultType="com.kongkong.member.vo.MemberVO">
		SELECT mem_id	
			 , mem_pass
			 , mem_name  
			 , mem_role	
			 , TO_CHAR(mem_bir,'YYYY-MM-DD') AS mem_bir 
			 , mem_zip
			 , mem_add1
			 , mem_add2
			 , mem_hp
			 , mem_mail
			 , mem_mileage
			 , mem_like
		  FROM member			
		 WHERE mem_id = #{gracePark}
	</select>
	
	
	<update id="changeMileage"
		parameterType="com.kongkong.member.vo.MemberVO">
		UPDATE member
		SET mem_mileage = #{memMileage}
		where mem_id = #{memId}
	</update>
	
	<select id="getMemCount" resultType="int">
		SELECT count(*) as mem_count
		FROM member
		WHERE 1=1
		<include refid="searchWhereClause"/>
	</select>
	
	<delete id="deleteMember">
	DELETE FROM MEMBER
	WHERE mem_id = #{memId}
	</delete>
	
	<update id="adModifyMember">
	UPDATE member
		SET  mem_name = #{memName}
      	   , mem_bir = #{memBir}
      	   , mem_zip = #{memZip}
      	   , mem_add1 = #{memAdd1}
      	   , mem_add2 = #{memAdd2}
      	   , mem_hp = #{memHp}
      	   , mem_mail = #{memMail}
      	   , mem_like = #{memLike}   
      WHERE mem_id = #{memId}
	</update>
	
	
</mapper>