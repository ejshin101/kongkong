<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>
<%@ taglib prefix="form" uri="http://www.springframework.org/tags/form"%>
<html>
<head>
<title>비행기 예약</title>
<link rel="stylesheet" type="text/css" href="<%=request.getContextPath()%>/resources/jquery/jquery.autocomplete.css" />
</head>
<body>
<%@ include file="/WEB-INF/inc/top.jsp"%>
<script type="text/javascript" src="<%=request.getContextPath()%>/resources/jquery/lib/jquery.js"></script>
<script type='text/javascript' src='<%=request.getContextPath()%>/resources/jquery/lib/jquery.bgiframe.min.js'></script>
<script type='text/javascript' src='<%=request.getContextPath()%>/resources/jquery/lib/jquery.ajaxQueue.js'></script>
<script type='text/javascript' src='<%=request.getContextPath()%>/resources/jquery/jquery.autocomplete.js'></script>
<div>
	  <input type="text" id="depAirport">
	  <input type="text" id="arrAirport">
	  <input type="date" class="form-control" id="starting">
	  <input type="date" class="form-control" id="ending">
	  <input type="button"  onclick="fn_searchClick()" value="검색">
	<div id="departure">departure</div>
	<div id="arrival">arrival</div>
	<div id="startDate">startDate</div>
	<div id="endDate">endDate</div>
	
</div>


<div style="height: 500px">
</div><!--   end    -->
	<script>
	var Tags=[];
	$(document).ready(function() {
	    $.ajax({
			url : "<c:url value='/reservation/airportInfo'/>",
			dataType : 'json',
			success : function(data) {
				for (var i=0; i<data.list1.length; i++) {
					Tags.push(data.list1[i]);
				}
				for (var i=0; i<data.list2.length; i++) {
					Tags.push(data.list2[i]);
				}
				$("#depAirport").autocomplete(Tags,{ 
			        matchContains: true,
			        selectFirst: true,
			    });
			    $("#arrAirport").autocomplete(Tags,{ 
			        matchContains: true,
			        selectFirst: true,
			    });
			}//success 
		}); // ajax --end
	});
	function fn_searchClick() {
		var departureAir= $("#depAirport").val()
		var arrivalAir= $("#arrAirport").val()
		var start =$("#starting").val();
		var end =$("#ending").val();
		$("#startDate").html(start);
		$("#endDate").html(end);
		$.ajax({
				url : "<c:url value='/reservation/flightInfo'/>",
				dataType : 'json',
				data : {
					departure : departureAir,
					arrival : arrivalAir
				},
				success : function(data) {
				$("#departure").html("출발 공항: " + $("#depAirport").val()+"코드"+data.depAir);
				$("#arrival").html("도착 공항: " + $("#arrAirport").val()+"코드"+data.arrAir);
				location.href='https://www.skyscanner.co.kr/transport/flights/'+data.depAir+'/'+data.arrAir+'/'+start+'/'+end+'/';
				}//success 
			}); // ajax --end
		}
	
	</script>
<%@ include file="/WEB-INF/inc/footer.jsp"%>
</body>
</html>