<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
    <%
    request.setCharacterEncoding("UTF-8");
    %>
<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<script type="text/javascript" src="https://cdn.iamport.kr/js/iamport.payment-1.1.5.js"></script>
<!-- 아래 제이쿼리는 1.0이상이면 원하는 버전을 사용하셔도 무방합니다. -->
<script type="text/javascript" src="https://code.jquery.com/jquery-1.12.4.min.js" ></script>
<script defer="defer">
	function iamport(){
		//가맹점 식별코드
		IMP.init('imp85907964');
		IMP.request_pay({
		    pg : 'kcp',
		    pay_method : 'card',
		    merchant_uid : 'merchant_' + new Date().getTime(),
		    name : '상품1' , //결제창에서 보여질 이름
		    amount : 1, //실제 결제되는 가격
		    buyer_email : 'iamport@siot.do',
		    buyer_name : '구매자이름',
		    buyer_tel : '010-1234-5678',
		    buyer_addr : '서울 강남구 도곡동',
		    buyer_postcode : '123-456'
		}, function(rsp) {
			console.log(rsp);
			// 결제검증
			$.ajax({
	        	type : "POST",
	        	url : "/Reservation/ReservationFrom/" + rsp.imp_uid 
	        }).done(function(data) {  
	        	
	        	console.log(data);
	        	
	        	// 위의 rsp.paid_amount 와 data.response.amount를 비교한후 로직 실행 (import 서버검증)
	        	if(rsp.paid_amount == data.response.amount){
		        	alert("결제 및 결제검증완료");
		        	//저장하는 ajax를 만들
	        	} else {
	        		alert("결제 실패");
	        	}
	        });
		});
	}
</script>
<title>Insert title here</title>
</head>
<body>
<%@include file="/WEB-INF/inc/top.jsp"%>
<div class="container">
	<div class="page-header">
		<h3>예약 게시판</h3>
	</div>
	
	<div class="row">
            <div class="col-md-4">예약일자</div>
            <div class="col-md-4"></div>
            <div class="col-md-4"></div>
        </div>
        <div class="row">
            <div class="col-md-1"></div>
            <div class="col-md-10">수령일 : <input type="date" name=""> 반납일 : <input type="date" ></div>
            <div class="col-md-1"></div>
        </div>
        <div class="row">
            <div class="col-md-4">수령/반납방법</div>
            <div class="col-md-4"></div>
            <div class="col-md-4"></div>
        </div>
        <div class="row">
            <div class="col-md-1"></div>
            <div class="col-md-10">
                수령방법 
                <select>
                    <option>선택하세요</option>
                    <option>택배</option>
                    <option>공항 직접 수령</option>
                </select>
                반납방법
                <select>
                    <option>선택하세요</option>
                    <option>택배</option>
                    <option>공항 직접 반납</option>
                </select>
            </div>
            <div class="col-md-1"></div>
        </div>
        <div class="row">
            예약자 성함 : <input type="text">
        </div>
        <div class="row">
            예약자 이메일 : <input type="email">
        </div>
        <div class="row">
            예약자 연락처 : <input type="text">
        </div>
        <div class="row">
            예약자 주소 : <input type="text">
        </div>
        <div class="row">
            예약자 우편번호 : <input type="text">
        </div>
        <div class="row">
        <div class="col-md-4">수량 : <input type="number"></div>
            <div class="col-md-4">와이파이 보험 선택 여부 <input type="radio"> yes <input type="radio"> no</div>
            <div class="col-md-4"></div>
            
            
        </div>
        <div class="row">
            <div class="col-md-4">옵션</div>
            <div class="col-md-4"></div>
            <div class="col-md-4"></div>
        </div>
        <div class="row">
            <div class="col-md-4">
                <p>보조배터리</p>
                <img src="<%=request.getContextPath()%>/resources/image/battery.png">
                <p>포켓와이파이 2회 충전가능</p>
            </div>
            <div class="col-md-4">
                <p>USB 멀티 충전기</p>
                <img src="<%=request.getContextPath()%>/resources/image/mplug.png">
                <p>전원 플러그 1개로 최대 5대를 고속 충전할 수 있는 멀티 충전기</p>
            </div>
            <div class="col-md-4">
                <p>5핀 USB 케이블</p>
                <img src="<%=request.getContextPath()%>/resources/image/5pin.png">
                <p>포켓 와이파이 충전과 데이터 전송에 사용할 수 있는 USB 케이블</p>
            </div>
        </div>

<button onclick="iamport()">결제하기</button>
</div> <!-- end .container -->
</body>
</html>