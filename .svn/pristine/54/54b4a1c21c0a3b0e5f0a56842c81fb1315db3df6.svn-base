<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<%@taglib prefix="paging" tagdir="/WEB-INF/tags/kongkong" %>
    <%
    request.setCharacterEncoding("UTF-8");
    %>
<!DOCTYPE html>
<html lang="ko">
<head>
<style>
       #sideBar {
        	border-style: solid;
            position: absolute;
            top: 200px;
            width: 150px;
        }
        #ad {
        	border-style: solid;
            position: absolute;
            top: 550px;
            height: 150px;
            width: 150px;
            background-color: aqua;
        }
    </style>
<meta charset="UTF-8">
<title>Insert title here</title>
</head>
<body>
<%@include file="/WEB-INF/inc/top.jsp"%>
<div style="height: 120px"></div>
<div class="container">
	<pre>
	${searchVO}
</pre>
<!-- START : 검색 폼  --> 
<div class="panel panel-default">
  <div class="panel-body">
    <form name="frm_search" action="reservationList" method="get" class="form-horizontal">
        <input type="hidden" name="curPage" value="${searchVO.curPage }">
        <input type="hidden" name="rowSizePerPage" value="${searchVO.rowSizePerPage }">
          <div class="form-group">
            <label for="id_searchType" class="col-sm-2 control-label">검색</label>
            <div class="col-sm-2">
	            <input type="radio" id="id_searchType" name="searchType" value="DT01"> 수령일
	            <input type="radio" id="id_searchType" name="searchType" value="DT02" > 반납일
	            <input type="radio" id="id_searchType" name="searchType" value="DT03" > 결제일
	            <input type="radio" id="id_searchType" name="searchType" value=""  checked> 선택안함
            </div>
            <div class="col-sm-2">	
            	<input type="date" name="searchStartDate" class="form-control input-sm" value="${searchVO.searchStartDate}">
            	<input type="date" name="searchEndDate" class="form-control input-sm" value="${searchVO.searchEndDate}">
            </div>
            <label for="id_searchCategory" class="col-sm-2 control-label">분류</label>
            <div class="col-sm-2">
                <select id="id_searchCategory" name="searchCategory" class="form-control input-sm">
                    <option value="">-- 전체 --</option>
                    <c:forEach items="${recode }" var="code">
						<option value="${code.commCd }"
						${searchVO.searchCategory eq code.commCd ? 'selected="selected"' : '' }>${code.commNm }</option>
					</c:forEach>
                </select>
            </div>
          </div>
          <div class="form-group">
            <div class="col-sm-2 col-sm-offset-9 text-right" >
              <button type="reset" id="id_btn_reset" class="btn btn-sm btn-default">
                    <i class="fa fa-sync"></i>
                    &nbsp;&nbsp;초기화 
                </button>
            </div>     
            <div class="col-sm-1 text-right" >
                <button type="submit" class="btn btn-sm btn-primary ">
                    <i class="fa fa-search"></i>
                    &nbsp;&nbsp;검 색
                </button>
            </div>
          </div>
    </form>
  </div>
</div>
<!-- END : 검색 폼  -->  

<!-- START : 목록건수 및 새글쓰기 버튼  --> 
<div class="row mb-10">
    <div class="col-sm-3 form-inline"  >
        전체 ${searchVO.totalRowCount} 건 조회
        <select id="id_rowSizePerPage" name="rowSizePerPage" class="form-control input-sm" >
            <option value="10"${searchVO.rowSizePerPage eq '10' ? 'selected="selected"' : '' } >10</option>
            <option value="20"${searchVO.rowSizePerPage eq '20' ? 'selected="selected"' : '' } >20</option>
            <option value="30"${searchVO.rowSizePerPage eq '30' ? 'selected="selected"' : '' } >30</option>
            <option value="50"${searchVO.rowSizePerPage eq '40' ? 'selected="selected"' : '' } >50</option>
        </select>
    </div>
</div>
<!-- END : 목록건수 및 새글쓰기 버튼  --> 
	<table class="table table-bordered table-hover text-center fifth-gray">
	<thead>
		<tr>
			<th>주문 번호</th>
			<th>품목</th>
			<th>금액</th>
			<th>결제일자</th>
		</tr>
	</thead>	
	<tbody>

	<c:forEach items="${results}" var="vo">
<tr>
		<td>${vo.bookMerchantUid}</td>
		<td>
		<c:choose>
		<c:when test="${USER_INFO.userRole eq 'admin'}">
		<a href="reservationAdminView.wow?bookMerchantUid=${vo.bookMerchantUid}&userRole">
		${vo.bookCdNm}
		</a>
		</c:when>
		<c:otherwise>
		<a href="reservationView.wow?bookMerchantUid=${vo.bookMerchantUid}">
		${vo.bookCdNm}
		</a>
		</c:otherwise>

		
		</c:choose>
		
		</td>
		<td>${vo.bookAmount}</td>
		<td>${vo.bookDate }</td>
	 </tr>
	 </c:forEach>
	</tbody>
	</table>
	<!-- start pagination -->
	<paging:pagingReserve pagingVO="${searchVO }"/>
	<!-- end pagination -->
</div> <!-- end .container -->

<script type="text/javascript">
// 전역변수 설정
// 자바스크립트 객체하고 jQuery 객체하고 구분하기 위해 jQuery 객체변수는 $로 시작
$frm = $('form[name=frm_search]');


// 일반 함수 설정

// 이벤트 함수 설정

// $frm이 서브밋 이벤트가 발생할 때
// curPage = 1로 변경 후 submit
$('button[type=submit]',$frm).click(function(e) {
	e.preventDefault();
	$frm.find("input[name=curPage]").val(1);
	$frm.submit();
});

//id_btn_reset 클릭할 때
//curPage = 1, 모든 객체는 초기화
$('#id_btn_reset').click(function(e) {
	e.preventDefault();
	$this = $(this);
	$frm.find("input[name=curPage]").val(1);
	$frm.find("input[name=searchStartDate]").val("");
	$frm.find("input[name=searchEndDate]").val("");
	$frm.find("select[name=searchType]").val("");
	$frm.find("#id_searchType:radio[value='']").attr("checked", true) ;

	//-------------selectbox 제어 방법 3가지
	//$frm.find("select[name=searchCategory]").val("");
	//$frm.find("select[name=searchCategory] option:first").attr("selected","selected");
	$frm.find("select[name=searchCategory] option:first").prop("selected",true); //권장
});

//pagination의 a 링크를 클릭했을 때
$('nav ul.pagination a[data-page]').click(function(e){
    e.preventDefault();
	$this = $(this);
    //console.log('this',this.dataset.page);  //javascript 객체
    //console.log('$this',$this.data('page')); //jQuery 객체
    
    $frm.find("input[name=curPage]").val($this.data('page'));
    $frm.submit();
}); // end 'nav ul.pagination a[data-page]').click

//rowSizePerPage 변경
$('#id_rowSizePerPage').change(function(e){
	e.preventDefault();
	$this = $(this);
	console.log('select val', $this.val());
    $frm.find("input[name=curPage]").val(1);
    $frm.find("input[name=rowSizePerPage]").val($this.val());
    $frm.submit();
	
});

// 초기화 호출
</script> 

</body>
</html>