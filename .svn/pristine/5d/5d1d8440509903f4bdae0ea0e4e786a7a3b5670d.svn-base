package com.kongkong.mail.sevice;

import java.util.Random;

import javax.mail.Message;
import javax.mail.MessagingException;
import javax.mail.internet.InternetAddress;
import javax.mail.internet.MimeMessage;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.mail.javamail.JavaMailSenderImpl;
import org.springframework.stereotype.Service;

@Service
public class MailSendService {
	
	@Autowired
    private JavaMailSenderImpl mailSender;

	public String getKey(int size) {
		Random random = new Random();
		StringBuffer buffer = new StringBuffer();
		int num = 0;
		
		while(buffer.length() < size) {
			num = random.nextInt(10);
			buffer.append(num);
		}
		return buffer.toString();
		
	}
	
	
	 public String sendnumMail(String memMail) {
	        String numKey = getKey(6);

	        MimeMessage mail = mailSender.createMimeMessage();
	        String mailContent = "인증번호:   "+numKey ;     //보낼 메시지 
	        try {
	            mail.setSubject("이메일인증 제목 ", "utf-8"); // 
	            mail.setText(mailContent, "utf-8", "html");   //보낼 메시지
	            mail.addRecipient(Message.RecipientType.TO, new InternetAddress(memMail));
	            mailSender.send(mail);
	        } catch (MessagingException e) {
	            e.printStackTrace();
	        }

	          return numKey;
	    }
}
